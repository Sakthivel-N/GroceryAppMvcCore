@using GroceryAppMvcCore;
@using System;
@using System.Linq;
@using System.Collections.Generic;
@model DeliveryVuew;
@{
    ViewBag.Title = "Delivery_Hnadlers";
    int val = Convert.ToInt32(ViewBag.val);
    //int totalOrders = 0;

    List<string> list = new List<string>();

 }   

if(val==1)
   {
         <h1>DeliveryList</h1>

   
    @foreach (Order order in Model.Orders)
    {
      if(Model.Deliveries.FirstOrDefault(m=>m.OrderId==order.OrderId)==null)

    {
        <h1>Order Id: @order.OrderId</h1>

         string[] list1 = (order.CartIdList.Split(","));
        list1 = list1.Take(list1.Count() - 1).ToArray();
        <table>
            <tr>

                
                <th>OrderId</th>
                <th>OrderDate</th>
                <th>Status</th>
                

            </tr>
            @foreach (string i in list1)

            {
                foreach (Delivery delivery in Model.Deliveries)
                {
                    if (delivery.DeliveryId == int.Parse(i))
                    {
                        <tr>
                           
                            <td>@delivery.OrderId</td>
                            <td>@order.OrderDate</td>
                            <td>@delivery.Status</td>
                        </tr>

                    }
                }


            }



        </table>
        <div>
            total Price :@order.TotalValue><br/>
       </div>
    }
    }

else if(val==2)
{
    
         <h1>Pickup_Delivery</h1>

   
   @foreach (Delivery delivery in Model.Deliveries)
    {
      if(Model.Deliveries.FirstOrDefault(m=>m.OrderId==delivery.OrderId)==null& delivery.Status==false)

    {
        <h1>Order Id: @delivery.OrderId</h1>
        
         string[] list1 = (delivery.CartIdList.Split(","));
        list1 = list1.Take(list1.Count() - 1).ToArray();

        
        <table>
            <tr>

                
                <th>OrderId</th>
                <th>OrderDate</th>
                <th>PickupDate</th>
                <th>Status</th>
                

            </tr>
            @foreach (string i in list1)

            {
                foreach (Order order in Model.Orders)
                {
                    if (delivery.DeliveryId == int.Parse(i))
                    {
                        <tr>
                           
                            <td>@delivery.OrderId</td>
                            <td>@order.OrderDate</td>
                            <td>@delivery.PickupDate</td>
                            <td>@delivery.Status</td>
                        </tr>

                      

                    }
                      
                }


            }



        </table>
        
    }
    }
    else if(val==3)
{
    
         <h1>ORDER_Delivered</h1>

   
   @foreach (Delivery delivery in Model.Deliveries)
    {
      if(Model.Deliveries.FirstOrDefault(m=>m.OrderId==delivery.OrderId)==null& delivery.Status==true)

    {
        <h1>Order Id: @delivery.OrderId</h1>
        
         string[] list1 = (delivery.CartIdList.Split(","));
        list1 = list1.Take(list1.Count() - 1).ToArray();

        
        <table>
            <tr>

                
                <th>OrderId</th>
                <th>OrderDate</th>
                <th>DeliveryDate</th>
                <th>Status</th>
                

            </tr>
            @foreach (string i in list1)

            {
                foreach (Order order in Model.Orders)
                {
                    if (delivery.DeliveryId == int.Parse(i))
                    {
                        <tr>
                           
                            <td>@delivery.OrderId</td>
                            <td>@order.OrderDate</td>
                            <td>@delivery.DeliveryDate</td>
                            <td>@delivery.Status</td>
                        </tr>

                      

                    }
                     
                }

                 
            }



        </table>
        
    }
    }


